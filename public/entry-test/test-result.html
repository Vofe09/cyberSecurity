<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --bg-light: #e6f8f7;
      --blue-main: #4fd1c5;
      --blue-light: #76e0d1;
      --blue-hover: #a0f0ea;
      --text-dark: #1e293b;
      --green-accent: #34d399;
      --warning-accent: #facc15;
      --blue-dark: #1f7a73;
      --soft-blue: #d0f8f5;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }

    body {
      background: var(--bg-light);
      color: var(--text-dark);
      min-height: 100vh;
    }

    /* ---------- HEADER ---------- */
    header {
        position: fixed;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 60%;
        margin-top: 10px;
        background-color: var(--blue-main);
        padding: 20px;
        border-radius: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        z-index: 1000;
    }


    nav {
        display: flex;
        gap: 20px;
    }

    nav a {
        color: white;
        text-decoration: none;
        background-color: var(--blue-light);
        padding: 10px 20px;
        border-radius: 20px;
        transition: 0.3s ease;
        opacity: 0;
        transform: translateY(-10px);
        animation: fadeIn 0.6s forwards;
        font-weight: bold;
    }

    nav a:hover {
        background-color: var(--blue-hover);
    }

    /* –ü–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ */
    nav a:nth-child(1) { animation-delay: 0.3s; }
    nav a:nth-child(2) { animation-delay: 0.45s; }
    nav a:nth-child(3) { animation-delay: 0.6s; }
    nav a:nth-child(4) { animation-delay: 0.75s; }
    nav a:nth-child(5) { animation-delay: 1.0s; }
    nav a:nth-child(6) { animation-delay: 1.25s; }
    
    @keyframes fadeIn {
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }


    main {
        max-width: 900px;
        margin: 140px auto 80px;
        padding: 0 20px;

        display: flex;
        flex-direction: column; /* –í–ê–ñ–ù–û */
        align-items: center;    /* —Ü–µ–Ω—Ç—Ä –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ */
        gap: 32px;              /* –û–¢–°–¢–£–ü –ú–ï–ñ–î–£ –ö–ê–†–¢–û–ß–ö–ê–ú–ò */
      }


    /* ---------- CARD ---------- */
    .card {
      background: white;
      border-radius: 24px;
      padding: 40px;
      width: 100%;
      max-width: 480px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.06);
      text-align: center;
    }

    .card h1 {
      margin-bottom: 24px;
      font-size: 26px;
    }

    /* ---------- GAUGE ---------- */
    .gauge-wrapper {
      width: 280px;
      height: 140px;
      overflow: hidden;
      margin: 30px auto;
    }

    .gauge {
      --value: 0;          /* 0‚Äì180 */
      --gauge-color: var(--blue-main);

      width: 280px;
      height: 280px;
      border-radius: 50%;
      background:
        conic-gradient(
          var(--gauge-color) calc(var(--value) * 1deg),
          #e5e7eb 0
        );
      transform: rotate(-90deg);
      transition: background 1s ease;
      position: relative;
    }

    .gauge-center {
      position: absolute;
      inset: 24px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding-bottom: 26px;
      transform: rotate(90deg);
    }

    .gauge-center span {
      font-size: 48px;   /* –∫—Ä—É–ø–Ω–æ –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ */
      font-weight: 800;
      line-height: 1;
      transform: translateY(-12px); /* ‚Üê –í–û–¢ –ó–î–ï–°–¨ */
    }

    /* ---------- STATS ---------- */
    .stats {
      display: flex;
      justify-content: space-between;
      margin-top: 24px;
      font-size: 15px;
    }

    .stats div {
      background: var(--soft-blue);
      padding: 10px 14px;
      border-radius: 14px;
      width: 48%;
    }

    .description {
      margin-top: 28px;
      font-size: 15px;
      color: #475569;
    }

    .gauge-subtext {
        margin-top: -12px;
        font-size: 15px;
        color: #475569;
      }

      .gauge-subtext span {
        font-weight: 600;
        color: var(--text-dark);
      }


        /* ---------- PIE ---------- */
    .pie-section {
      margin-top: 40px;
    }

    .pie-section h2 {
      font-size: 20px;
      margin-bottom: 20px;
    }

    .pie-wrapper {
      width: 220px;
      height: 220px;
      margin: 0 auto 20px;
    }

    .pie {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: #e5e7eb;
      transition: background 1s ease;
    }

    .legend {
      display: flex;
      flex-direction: column;
      gap: 10px;
      font-size: 14px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .legend-color {
      width: 14px;
      height: 14px;
      border-radius: 50%;
    }


    .card {
      opacity: 0;
      transform: translateY(20px);
      animation: cardFadeIn 0.6s ease forwards;
    }

    .card:nth-child(2) {
      animation-delay: 0.3s;
    }

    @keyframes cardFadeIn {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .pie {
      transform: scale(0.9) rotate(-90deg);
      opacity: 0;
      transition:
        background 1.2s ease,
        transform 0.6s ease,
        opacity 0.6s ease;
    }

    .legend-item {
  opacity: 0;
  transform: translateX(-10px);
  animation: legendFade 0.4s ease forwards;
}

.legend-item:nth-child(1) { animation-delay: 0.7s; }
.legend-item:nth-child(2) { animation-delay: 0.85s; }
.legend-item:nth-child(3) { animation-delay: 1s; }

@keyframes legendFade {
  to {
    opacity: 1;
    transform: translateX(0);
  }
}


  </style>
</head>

<body>

<header>
    <nav>
        <a href="#" class="lighter">–û –Ω–∞—Å</a>
        <a href="#">–í—Ö–æ–¥–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
        <a href="#">–û–±—É—á–µ–Ω–∏–µ</a>
        <a href="#"> –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ </a>
        <a href="#"> –ò–≥—Ä–∞ </a>
        <a href="#"> –ü—Ä–æ—Ñ–∏–ª—å </a>
    </nav>
</header>

<main>
  <div class="card">
    <h1>–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</h1>

    <div class="gauge-wrapper">
      <div class="gauge" id="gauge">
        <div class="gauge-center">
          <span id="percentText">0%</span>
        </div>
      </div>
    </div>

    <div class="gauge-subtext">
      <span id="correctPercentText">0%</span> –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
    </div>


    <div class="stats">
      <div>‚úî –ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö: <strong id="correctCount">0</strong></div>
      <div>‚úñ –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö: <strong id="wrongCount">0</strong></div>
    </div>

    <div class="description" id="resultText">
      –†–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ—Ç –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∞.
    </div>
</div>
<div class="card">
        <!-- ===== PIE CHART ===== -->
    <div class="pie-section">
      <h2>–ì–¥–µ –±—ã–ª–∏ –æ—à–∏–±–∫–∏</h2>

      <div class="pie-wrapper">
        <div class="pie" id="pieChart"></div>
      </div>

      <div class="legend" id="pieLegend"></div>
    </div>

  </div>
</main>

<script>
/* =====================================================
   –í–†–ï–ú–ï–ù–ù–ê–Ø –ó–ê–ì–õ–£–®–ö–ê
   ‚Üì‚Üì‚Üì
   –ü–û–¢–û–ú –ó–ê–ú–ï–ù–ò–ú –ù–ê –î–ê–ù–ù–´–ï –ò–ó index.html (localStorage)
   ===================================================== */

const resultModel = JSON.parse(
  localStorage.getItem("cyberAware:testResult")
);

if (!resultModel) {
  // –∑–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä—è–º–æ–≥–æ –∑–∞—Ö–æ–¥–∞
  window.location.href = "index.html";
}


/* =====================================================
   –õ–û–ì–ò–ö–ê –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø
   ===================================================== */

const percent = Math.round((resultModel.correct / resultModel.total) * 100);
const gauge = document.getElementById("gauge");
const percentText = document.getElementById("percentText");
const correctEl = document.getElementById("correctCount");
const wrongEl = document.getElementById("wrongCount");
const resultText = document.getElementById("resultText");

/* —Ü–≤–µ—Ç –ø–æ —É—Ä–æ–≤–Ω—é */
let color = "#34d399";
let text = "–•–æ—Ä–æ—à–∞—è —Ü–∏—Ñ—Ä–æ–≤–∞—è –≥–∏–≥–∏–µ–Ω–∞.";

if (percent < 40) {
  color = "#f87171";
  text = "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –∑–∞—â–∏—Ç—ã. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ —Å –±–∞–∑–æ–≤—ã—Ö —Ç–µ–º.";
} else if (percent < 65) {
  color = "#facc15";
  text = "–ï—Å—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç–∏. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏ —Å—Ç–æ–∏—Ç –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å.";
} else if (percent < 85) {
  color = "#4fd1c5";
  text = "–ù–µ–ø–ª–æ—Ö–æ–π —É—Ä–æ–≤–µ–Ω—å, –Ω–æ –µ—Å—Ç—å –∑–æ–Ω—ã –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è.";
}

/* –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ */
gauge.style.setProperty("--value", 0);
document.getElementById("correctPercentText").textContent = "0%";


setTimeout(() => {
  gauge.style.setProperty("--value", percent * 1.8);

  let current = 0;
  const interval = setInterval(() => {
    if (current >= percent) {
      clearInterval(interval);
    } else {
      current++;
      percentText.textContent = current + "%";
      document.getElementById("correctPercentText").textContent = current + "%";
    }
  }, 15);
}, 300);

correctEl.textContent = resultModel.correct;
wrongEl.textContent = resultModel.incorrect;
resultText.textContent = text;



resultModel.errorsByCategory = {
  –§–∏—à–∏–Ω–≥: 3,
  –ü–∞—Ä–æ–ª–∏: 1,
  "–ü—É–±–ª–∏—á–Ω—ã–π Wi-Fi": 2
};

/* –¶–≤–µ—Ç–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π */
const categoryColors = {
  –§–∏—à–∏–Ω–≥: "#facc15",
  –ü–∞—Ä–æ–ª–∏: "#4fd1c5",
  "–ü—É–±–ª–∏—á–Ω—ã–π Wi-Fi": "#fb7185",
  –§–∏–Ω–∞–Ω—Å—ã: "#60a5fa"
};

const pie = document.getElementById("pieChart");
const legend = document.getElementById("pieLegend");

const errors = resultModel.errorsByCategory;
const totalErrors = Object.values(errors).reduce((a, b) => a + b, 0);

pie.style.background = "#e5e7eb";
if (totalErrors === 0) {
  pie.style.background = "#e5e7eb";
  legend.innerHTML = "<p>–û—à–∏–±–æ–∫ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ üéâ</p>";
} else {
  let currentPercent = 0;
  const slices = [];

  Object.entries(errors).forEach(([category, count]) => {
    const percent = (count / totalErrors) * 100;
    const color = categoryColors[category] || "#94a3b8";

    slices.push(
      `${color} ${currentPercent}% ${currentPercent + percent}%`
    );

    currentPercent += percent;

    /* –ª–µ–≥–µ–Ω–¥–∞ */
    const item = document.createElement("div");
    item.className = "legend-item";
    item.innerHTML = `
      <span class="legend-color" style="background:${color}"></span>
      ${category} ‚Äî ${count}
    `;
    legend.appendChild(item);
  });

  setTimeout(() => {
  pie.style.opacity = "1";
  pie.style.transform = "scale(1) rotate(0deg)";
  pie.style.background = `conic-gradient(${slices.join(", ")})`;
}, 600);

}
</script>

</body>
</html>
