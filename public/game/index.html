<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Игра — cyberAware</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --bg-light: #e6f8f7;
      --blue-main: #4fd1c5;
      --blue-hover: #a0f0ea;
      --green: #34d399;
      --red: #f87171;
      --text-dark: #1e293b;
      --soft-blue: #d0f8f5;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, sans-serif;
    }

    body {
      background: var(--bg-light);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-dark);
    }

    .quiz-card {
      background: white;
      width: 100%;
      max-width: 480px;
      border-radius: 24px;
      padding: 32px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    }

    .progress {
      font-size: 14px;
      color: #475569;
      margin-bottom: 16px;
    }

    .question {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 24px;
    }

    .answers {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .answer {
      background: var(--soft-blue);
      padding: 16px;
      border-radius: 14px;
      cursor: pointer;
      text-align: center;
      transition: background 0.2s ease;
      font-weight: 500;
    }

    .answer:hover {
      background: var(--blue-hover);
    }

    .answer.correct {
      background: var(--green);
      color: white;
    }

    .answer.wrong {
      background: var(--red);
      color: white;
    }

    .answer.disabled {
      pointer-events: none;
      opacity: 0.6;
    }

    .next {
      margin-top: 24px;
      width: 100%;
      padding: 14px;
      border-radius: 14px;
      border: none;
      background: var(--blue-main);
      color: white;
      font-size: 16px;
      cursor: pointer;
      display: none;
    }
  </style>
</head>

<body>

<div class="quiz-card">
  <div class="progress" id="progress">Вопрос 1 из 3</div>
  <div class="question" id="questionText"></div>

  <div class="answers" id="answers"></div>

  <button class="next" id="nextBtn">Далее</button>
</div>

<script>
/* ===== ВОПРОСЫ (ПОТОМ ЗАМЕНИМ / РАСШИРИМ) ===== */
const questions = [
  {
    text: "Что из этого является признаком фишинга?",
    answers: [
      "Персонализированное обращение",
      "Срочность и давление",
      "Официальный домен сайта",
      "Отсутствие ошибок в тексте"
    ],
    correct: 1
  },
  {
    text: "Какой пароль считается безопасным?",
    answers: [
      "qwerty123",
      "один пароль для всех сайтов",
      "случайный и уникальный",
      "дата рождения"
    ],
    correct: 2
  },
  {
    text: "Что лучше сделать в публичном Wi-Fi?",
    answers: [
      "Войти в интернет-банк",
      "Скачать подозрительный файл",
      "Использовать VPN",
      "Отключить антивирус"
    ],
    correct: 2
  }
];

let current = 0;
let answered = false;
let correctCount = 0;

const questionText = document.getElementById("questionText");
const answersEl = document.getElementById("answers");
const progress = document.getElementById("progress");
const nextBtn = document.getElementById("nextBtn");
const savedQuestionIndex =
  localStorage.getItem("cyberAware:returnToQuestion");

if (savedQuestionIndex !== null) {
  current = Number(savedQuestionIndex);
  localStorage.removeItem("cyberAware:returnToQuestion");
}


/* ===== ЗАГРУЗКА ВОПРОСА ===== */
function loadQuestion() {
  answered = false;
  nextBtn.style.display = "none";
  answersEl.innerHTML = "";

  const q = questions[current];
  progress.textContent = `Вопрос ${current + 1} из 3`;
  questionText.textContent = q.text;

  q.answers.forEach((text, index) => {
    const btn = document.createElement("div");
    btn.className = "answer";
    btn.textContent = text;

    btn.addEventListener("click", () => handleAnswer(btn, index));
    answersEl.appendChild(btn);
  });
}

/* ===== ОБРАБОТКА ОТВЕТА ===== */
function handleAnswer(btn, index) {
  if (answered) return;
  answered = true;

  const correctIndex = questions[current].correct;
  const buttons = document.querySelectorAll(".answer");

  buttons.forEach((b, i) => {
    b.classList.add("disabled");
    if (i === correctIndex) b.classList.add("correct");
    if (i === index && i !== correctIndex) b.classList.add("wrong");
  });

  if (index === correctIndex) {
    correctCount++; // ← ВАЖНО
  }

  nextBtn.style.display = "block";
}


/* ===== ПЕРЕХОД ===== */
nextBtn.addEventListener("click", () => {
    if (correctCount >= 3) {
    window.location.href = "/game/mini-game.html";
    return;
    }


  current++;

  if (current < questions.length) {
    loadQuestion();
  } else {
    alert("Вопросы закончились");
  }
});


/* ===== INIT ===== */
loadQuestion();
</script>

</body>
</html>
